
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Mdl format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>Mdl format specification</h1>

      
<a name='type-mdl'></a>
<h1>Type: Mdl</h1>

<p>BioWare MDL Model Format

The MDL file contains:
- File header (12 bytes)
- Geometry header (80 bytes)
- Model header (92 bytes)
- Names header (28 bytes)
- Node name arrays
- Animation headers and nodes
- Node hierarchy with geometry data

Reference implementations:
- https://github.com/OldRepublicDevs/PyKotor/blob/master/vendor/MDLOps/MDLOpsM.pm
- https://github.com/OldRepublicDevs/PyKotor/wiki/MDL-MDX-File-Format.md
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>file_header</td>
<td><a href="#type-mdl-file_header">FileHeader</a></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>geometry_header</td>
<td><a href="#type-mdl-geometry_header">GeometryHeader</a></td>
<td></td>
</tr>
<tr>
<td>92</td>
<td>...</td>
<td>model_header</td>
<td><a href="#type-mdl-model_header">ModelHeader</a></td>
<td></td>
</tr>
<tr>
<td>180</td>
<td>...</td>
<td>names_header</td>
<td><a href="#type-mdl-names_header">NamesHeader</a></td>
<td></td>
</tr>
</table>
<p><b>Parse instance</b>: animations</p>
<table class="table">
<tr>
<td>data_start + model_header.animation_array_offset</td>
<td>...</td>
<td>animations</td>
<td><a href="#type-mdl-animation_header">AnimationHeader</a></td>
<td>Animation header array</td>
</tr>
</table>
value instance: ValueInstanceSpec(InstanceIdentifier(data_start),List(instances, data_start),IntNum(12),None,Some(Int1Type(true)),DocSpec(Some(MDL "data start" offset. Most offsets in this file are relative to the start of the MDL data
section, which begins immediately after the 12-byte file header.
),List()))
<p><b>Parse instance</b>: name_indexes</p>
<table class="table">
<tr>
<td>data_start + names_header.names_array_offset</td>
<td>...</td>
<td>name_indexes</td>
<td>u4le</td>
<td>Array of name string offsets (relative to data_start)</td>
</tr>
</table>
<p><b>Parse instance</b>: names_data</p>
<table class="table">
<tr>
<td>(data_start + names_header.names_array_offset) + 4 * names_header.name_count</td>
<td>...</td>
<td>names_data</td>
<td><a href="#type-mdl-name_strings">NameStrings</a></td>
<td>Name string blob (substream). This follows the name index array and continues up to the animation array.
Parsed as null-terminated ASCII strings in `name_strings`.
</td>
</tr>
</table>
<p><b>Parse instance</b>: root_node</p>
<table class="table">
<tr>
<td>data_start + geometry_header.root_node_offset</td>
<td>...</td>
<td>root_node</td>
<td><a href="#type-mdl-node">Node</a></td>
<td></td>
</tr>
</table>
<a name='enum-mdl-controller_type'></a>
<h2>Enum: controller_type</h2>

<table class="table">
<tr>
<th>ID</th><th>Name</th><th>Note</th>
</tr>
<tr>
<td>8</td><td>position</td><td></td></tr>
</tr>
<tr>
<td>20</td><td>orientation</td><td></td></tr>
</tr>
<tr>
<td>36</td><td>scale</td><td></td></tr>
</tr>
<tr>
<td>76</td><td>color</td><td></td></tr>
</tr>
<tr>
<td>88</td><td>radius</td><td></td></tr>
</tr>
<tr>
<td>96</td><td>shadow_radius</td><td></td></tr>
</tr>
<tr>
<td>100</td><td>vertical_displacement_or_drag_or_selfillumcolor</td><td></td></tr>
</tr>
<tr>
<td>132</td><td>alpha</td><td></td></tr>
</tr>
<tr>
<td>140</td><td>multiplier_or_randvel</td><td></td></tr>
</tr>
</table>
<a name='enum-mdl-model_classification'></a>
<h2>Enum: model_classification</h2>

<table class="table">
<tr>
<th>ID</th><th>Name</th><th>Note</th>
</tr>
<tr>
<td>0</td><td>other</td><td></td></tr>
</tr>
<tr>
<td>1</td><td>effect</td><td></td></tr>
</tr>
<tr>
<td>2</td><td>tile</td><td></td></tr>
</tr>
<tr>
<td>4</td><td>character</td><td></td></tr>
</tr>
<tr>
<td>8</td><td>door</td><td></td></tr>
</tr>
<tr>
<td>16</td><td>lightsaber</td><td></td></tr>
</tr>
<tr>
<td>32</td><td>placeable</td><td></td></tr>
</tr>
<tr>
<td>64</td><td>flyer</td><td></td></tr>
</tr>
</table>
<a name='enum-mdl-node_type_value'></a>
<h2>Enum: node_type_value</h2>

<table class="table">
<tr>
<th>ID</th><th>Name</th><th>Note</th>
</tr>
<tr>
<td>1</td><td>dummy</td><td></td></tr>
</tr>
<tr>
<td>3</td><td>light</td><td></td></tr>
</tr>
<tr>
<td>5</td><td>emitter</td><td></td></tr>
</tr>
<tr>
<td>17</td><td>reference</td><td></td></tr>
</tr>
<tr>
<td>33</td><td>trimesh</td><td></td></tr>
</tr>
<tr>
<td>97</td><td>skinmesh</td><td></td></tr>
</tr>
<tr>
<td>161</td><td>animmesh</td><td></td></tr>
</tr>
<tr>
<td>289</td><td>danglymesh</td><td></td></tr>
</tr>
<tr>
<td>545</td><td>aabb</td><td></td></tr>
</tr>
<tr>
<td>2081</td><td>lightsaber</td><td></td></tr>
</tr>
</table>
<a name='type-mdl-aabb_header'></a>
<h2>Type: AabbHeader</h2>

<p>AABB (Axis-Aligned Bounding Box) header (336 bytes KOTOR 1, 344 bytes KOTOR 2) - extends trimesh_header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>trimesh_base</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td>Standard trimesh header</td>
</tr>
<tr>
<td>344</td>
<td>...</td>
<td>unknown</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
</table>
<a name='type-mdl-animation_event'></a>
<h2>Type: AnimationEvent</h2>

<p>Animation event (36 bytes)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>activation_time</td>
<td>f4le</td>
<td>Time in seconds when event triggers during animation playback</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>event_name</td>
<td>str(ASCII)</td>
<td>Name of event (null-terminated string, e.g., "detonate")</td>
</tr>
</table>
<a name='type-mdl-animation_header'></a>
<h2>Type: AnimationHeader</h2>

<p>Animation header (136 bytes = 80 byte geometry header + 56 byte animation header)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>geo_header</td>
<td><a href="#type-mdl-geometry_header">GeometryHeader</a></td>
<td>Standard 80-byte geometry header (geometry_type = 0x01 for animation)</td>
</tr>
<tr>
<td>80</td>
<td>...</td>
<td>animation_length</td>
<td>f4le</td>
<td>Duration of animation in seconds</td>
</tr>
<tr>
<td>84</td>
<td>...</td>
<td>transition_time</td>
<td>f4le</td>
<td>Transition/blend time to this animation in seconds</td>
</tr>
<tr>
<td>88</td>
<td>...</td>
<td>animation_root</td>
<td>str(ASCII)</td>
<td>Root node name for animation (null-terminated string)</td>
</tr>
<tr>
<td>120</td>
<td>...</td>
<td>event_array_offset</td>
<td>u4le</td>
<td>Offset to animation events array</td>
</tr>
<tr>
<td>124</td>
<td>...</td>
<td>event_count</td>
<td>u4le</td>
<td>Number of animation events</td>
</tr>
<tr>
<td>128</td>
<td>...</td>
<td>event_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of event count</td>
</tr>
<tr>
<td>132</td>
<td>...</td>
<td>unknown</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
</table>
<a name='type-mdl-animmesh_header'></a>
<h2>Type: AnimmeshHeader</h2>

<p>Animmesh header (388 bytes KOTOR 1, 396 bytes KOTOR 2) - extends trimesh_header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>trimesh_base</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td>Standard trimesh header</td>
</tr>
<tr>
<td>344</td>
<td>...</td>
<td>unknown</td>
<td>f4le</td>
<td>Purpose unknown</td>
</tr>
<tr>
<td>348</td>
<td>...</td>
<td>unknown_array</td>
<td><a href="#type-mdl-array_definition">ArrayDefinition</a></td>
<td>Unknown array definition</td>
</tr>
<tr>
<td>360</td>
<td>...</td>
<td>unknown_floats</td>
<td>f4le</td>
<td>Unknown float values</td>
</tr>
</table>
<a name='type-mdl-array_definition'></a>
<h2>Type: ArrayDefinition</h2>

<p>Array definition structure (offset, count, count duplicate)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>offset</td>
<td>s4le</td>
<td>Offset to array (relative to MDL data start, offset 12)</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>count</td>
<td>u4le</td>
<td>Number of used entries</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>count_duplicate</td>
<td>u4le</td>
<td>Duplicate of count (allocated entries)</td>
</tr>
</table>
<a name='type-mdl-controller'></a>
<h2>Type: Controller</h2>

<p>Controller structure (16 bytes) - defines animation data for a node property over time</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>type</td>
<td>u4le</td>
<td>Controller type identifier. Controllers define animation data for node properties over time.

Common Node Controllers (used by all node types):
- 8: Position (3 floats: X, Y, Z translation)
- 20: Orientation (4 floats: quaternion W, X, Y, Z rotation)
- 36: Scale (3 floats: X, Y, Z scale factors)

Light Controllers (specific to light nodes):
- 76: Color (light color, 3 floats: R, G, B)
- 88: Radius (light radius, 1 float)
- 96: Shadow Radius (shadow casting radius, 1 float)
- 100: Vertical Displacement (vertical offset, 1 float)
- 140: Multiplier (light intensity multiplier, 1 float)

Emitter Controllers (specific to emitter nodes):
- 80: Alpha End (final alpha value, 1 float)
- 84: Alpha Start (initial alpha value, 1 float)
- 88: Birth Rate (particle spawn rate, 1 float)
- 92: Bounce Coefficient (particle bounce factor, 1 float)
- 96: Combine Time (particle combination timing, 1 float)
- 100: Drag (particle drag/resistance, 1 float)
- 104: FPS (frames per second, 1 float)
- 108: Frame End (ending frame number, 1 float)
- 112: Frame Start (starting frame number, 1 float)
- 116: Gravity (gravity force, 1 float)
- 120: Life Expectancy (particle lifetime, 1 float)
- 124: Mass (particle mass, 1 float)
- 128: P2P Bezier 2 (point-to-point bezier control point 2, varies)
- 132: P2P Bezier 3 (point-to-point bezier control point 3, varies)
- 136: Particle Rotation (particle rotation speed/angle, 1 float)
- 140: Random Velocity (random velocity component, 3 floats: X, Y, Z)
- 144: Size Start (initial particle size, 1 float)
- 148: Size End (final particle size, 1 float)
- 152: Size Start Y (initial particle size Y component, 1 float)
- 156: Size End Y (final particle size Y component, 1 float)
- 160: Spread (particle spread angle, 1 float)
- 164: Threshold (threshold value, 1 float)
- 168: Velocity (particle velocity, 3 floats: X, Y, Z)
- 172: X Size (particle X dimension size, 1 float)
- 176: Y Size (particle Y dimension size, 1 float)
- 180: Blur Length (motion blur length, 1 float)
- 184: Lightning Delay (lightning effect delay, 1 float)
- 188: Lightning Radius (lightning effect radius, 1 float)
- 192: Lightning Scale (lightning effect scale factor, 1 float)
- 196: Lightning Subdivide (lightning subdivision count, 1 float)
- 200: Lightning Zig Zag (lightning zigzag pattern, 1 float)
- 216: Alpha Mid (mid-point alpha value, 1 float)
- 220: Percent Start (starting percentage, 1 float)
- 224: Percent Mid (mid-point percentage, 1 float)
- 228: Percent End (ending percentage, 1 float)
- 232: Size Mid (mid-point particle size, 1 float)
- 236: Size Mid Y (mid-point particle size Y component, 1 float)
- 240: Random Birth Rate (randomized particle spawn rate, 1 float)
- 252: Target Size (target particle size, 1 float)
- 256: Number of Control Points (control point count, 1 float)
- 260: Control Point Radius (control point radius, 1 float)
- 264: Control Point Delay (control point delay timing, 1 float)
- 268: Tangent Spread (tangent spread angle, 1 float)
- 272: Tangent Length (tangent vector length, 1 float)
- 284: Color Mid (mid-point color, 3 floats: R, G, B)
- 380: Color End (final color, 3 floats: R, G, B)
- 392: Color Start (initial color, 3 floats: R, G, B)
- 502: Emitter Detonate (detonation trigger, 1 float)

Mesh Controllers (used by all mesh node types: trimesh, skinmesh, animmesh, danglymesh, AABB, lightsaber):
- 100: SelfIllumColor (self-illumination color, 3 floats: R, G, B)
- 128: Alpha (transparency/opacity, 1 float)

Reference: https://github.com/OldRepublicDevs/PyKotor/wiki/MDL-MDX-File-Format.md - Additional Controller Types section
Reference: https://github.com/OldRepublicDevs/PyKotor/blob/master/vendor/MDLOps/MDLOpsM.pm:342-407 - Controller type definitions
Reference: https://github.com/xoreos/xoreos-docs/blob/master/specs/torlack/binmdl.html - Comprehensive controller list
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>unknown</td>
<td>u2le</td>
<td>Purpose unknown, typically 0xFFFF</td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>row_count</td>
<td>u2le</td>
<td>Number of keyframe rows (timepoints) for this controller</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>time_index</td>
<td>u2le</td>
<td>Index into controller data array where time values begin</td>
</tr>
<tr>
<td>10</td>
<td>...</td>
<td>data_index</td>
<td>u2le</td>
<td>Index into controller data array where property values begin</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>column_count</td>
<td>u1</td>
<td>Number of float values per keyframe (e.g., 3 for position XYZ, 4 for quaternion WXYZ)
If bit 4 (0x10) is set, controller uses Bezier interpolation and stores 3× data per keyframe
</td>
</tr>
<tr>
<td>13</td>
<td>...</td>
<td>padding</td>
<td>u1</td>
<td>Padding bytes for 16-byte alignment</td>
</tr>
</table>
value instance: ValueInstanceSpec(InstanceIdentifier(uses_bezier),List(types, controller, instances, uses_bezier),Compare(BinOp(Name(identifier(column_count)),BitAnd,IntNum(16)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(Some(True if controller uses Bezier interpolation),List()))
<a name='type-mdl-danglymesh_header'></a>
<h2>Type: DanglymeshHeader</h2>

<p>Danglymesh header (360 bytes KOTOR 1, 368 bytes KOTOR 2) - extends trimesh_header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>trimesh_base</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td>Standard trimesh header</td>
</tr>
<tr>
<td>344</td>
<td>...</td>
<td>constraints_offset</td>
<td>u4le</td>
<td>Offset to vertex constraint values array</td>
</tr>
<tr>
<td>348</td>
<td>...</td>
<td>constraints_count</td>
<td>u4le</td>
<td>Number of vertex constraints (matches vertex count)</td>
</tr>
<tr>
<td>352</td>
<td>...</td>
<td>constraints_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of constraints count</td>
</tr>
<tr>
<td>356</td>
<td>...</td>
<td>displacement</td>
<td>f4le</td>
<td>Maximum displacement distance for physics simulation</td>
</tr>
<tr>
<td>360</td>
<td>...</td>
<td>tightness</td>
<td>f4le</td>
<td>Tightness/stiffness of spring simulation (0.0-1.0)</td>
</tr>
<tr>
<td>364</td>
<td>...</td>
<td>period</td>
<td>f4le</td>
<td>Oscillation period in seconds</td>
</tr>
<tr>
<td>368</td>
<td>...</td>
<td>unknown</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
</table>
<a name='type-mdl-emitter_header'></a>
<h2>Type: EmitterHeader</h2>

<p>Emitter header (224 bytes)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>dead_space</td>
<td>f4le</td>
<td>Minimum distance from emitter before particles become visible</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>blast_radius</td>
<td>f4le</td>
<td>Radius of explosive/blast particle effects</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>blast_length</td>
<td>f4le</td>
<td>Length/duration of blast effects</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>branch_count</td>
<td>u4le</td>
<td>Number of branching paths for particle trails</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>control_point_smoothing</td>
<td>f4le</td>
<td>Smoothing factor for particle path control points</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>x_grid</td>
<td>u4le</td>
<td>Grid subdivisions along X axis for particle spawning</td>
</tr>
<tr>
<td>24</td>
<td>...</td>
<td>y_grid</td>
<td>u4le</td>
<td>Grid subdivisions along Y axis for particle spawning</td>
</tr>
<tr>
<td>28</td>
<td>...</td>
<td>padding_unknown</td>
<td>u4le</td>
<td>Purpose unknown or padding</td>
</tr>
<tr>
<td>32</td>
<td>...</td>
<td>update_script</td>
<td>str(ASCII)</td>
<td>Update behavior script name (e.g., "single", "fountain")</td>
</tr>
<tr>
<td>64</td>
<td>...</td>
<td>render_script</td>
<td>str(ASCII)</td>
<td>Render mode script name (e.g., "normal", "billboard_to_local_z")</td>
</tr>
<tr>
<td>96</td>
<td>...</td>
<td>blend_script</td>
<td>str(ASCII)</td>
<td>Blend mode script name (e.g., "normal", "lighten")</td>
</tr>
<tr>
<td>128</td>
<td>...</td>
<td>texture_name</td>
<td>str(ASCII)</td>
<td>Particle texture name (null-terminated string)</td>
</tr>
<tr>
<td>160</td>
<td>...</td>
<td>chunk_name</td>
<td>str(ASCII)</td>
<td>Associated model chunk name (null-terminated string)</td>
</tr>
<tr>
<td>192</td>
<td>...</td>
<td>two_sided_texture</td>
<td>u4le</td>
<td>1 if texture should render two-sided, 0 for single-sided</td>
</tr>
<tr>
<td>196</td>
<td>...</td>
<td>loop</td>
<td>u4le</td>
<td>1 if particle system loops, 0 for single playback</td>
</tr>
<tr>
<td>200</td>
<td>...</td>
<td>render_order</td>
<td>u2le</td>
<td>Rendering priority/order for particle sorting</td>
</tr>
<tr>
<td>202</td>
<td>...</td>
<td>frame_blending</td>
<td>u1</td>
<td>1 if frame blending enabled, 0 otherwise</td>
</tr>
<tr>
<td>203</td>
<td>...</td>
<td>depth_texture_name</td>
<td>str(ASCII)</td>
<td>Depth/softparticle texture name (null-terminated string)</td>
</tr>
<tr>
<td>235</td>
<td>...</td>
<td>padding</td>
<td>u1</td>
<td>Padding byte for alignment</td>
</tr>
<tr>
<td>236</td>
<td>...</td>
<td>flags</td>
<td>u4le</td>
<td>Emitter behavior flags bitmask (P2P, bounce, inherit, etc.)</td>
</tr>
</table>
<a name='type-mdl-file_header'></a>
<h2>Type: FileHeader</h2>

<p>MDL file header (12 bytes)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>unused</td>
<td>u4le</td>
<td>Always 0</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>mdl_size</td>
<td>u4le</td>
<td>Size of MDL file in bytes</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>mdx_size</td>
<td>u4le</td>
<td>Size of MDX file in bytes</td>
</tr>
</table>
<a name='type-mdl-geometry_header'></a>
<h2>Type: GeometryHeader</h2>

<p>Geometry header (80 bytes) - Located at offset 12</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>function_pointer_0</td>
<td>u4le</td>
<td>Game engine version identifier:
- KOTOR 1 PC: 4273776 (0x413750)
- KOTOR 2 PC: 4285200 (0x416610)
- KOTOR 1 Xbox: 4254992 (0x40EE90)
- KOTOR 2 Xbox: 4285872 (0x416950)
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>function_pointer_1</td>
<td>u4le</td>
<td>Function pointer to ASCII model parser</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>model_name</td>
<td>str(ASCII)</td>
<td>Model name (null-terminated string, max 32 bytes)</td>
</tr>
<tr>
<td>40</td>
<td>...</td>
<td>root_node_offset</td>
<td>u4le</td>
<td>Offset to root node structure (relative to MDL data start, offset 12)</td>
</tr>
<tr>
<td>44</td>
<td>...</td>
<td>node_count</td>
<td>u4le</td>
<td>Total number of nodes in model hierarchy</td>
</tr>
<tr>
<td>48</td>
<td>...</td>
<td>unknown_array_1</td>
<td><a href="#type-mdl-array_definition">ArrayDefinition</a></td>
<td>Unknown array definition (offset, count, count duplicate)</td>
</tr>
<tr>
<td>60</td>
<td>...</td>
<td>unknown_array_2</td>
<td><a href="#type-mdl-array_definition">ArrayDefinition</a></td>
<td>Unknown array definition (offset, count, count duplicate)</td>
</tr>
<tr>
<td>72</td>
<td>...</td>
<td>reference_count</td>
<td>u4le</td>
<td>Reference count (initialized to 0, incremented when model is referenced)</td>
</tr>
<tr>
<td>76</td>
<td>...</td>
<td>geometry_type</td>
<td>u1</td>
<td>Geometry type:
- 0x01: Basic geometry header (not in models)
- 0x02: Model geometry header
- 0x05: Animation geometry header
If bit 7 (0x80) is set, model is compiled binary with absolute addresses
</td>
</tr>
<tr>
<td>77</td>
<td>...</td>
<td>padding</td>
<td>u1</td>
<td>Padding bytes for alignment</td>
</tr>
</table>
value instance: ValueInstanceSpec(InstanceIdentifier(is_kotor2),List(types, geometry_header, instances, is_kotor2),BoolOp(Or,List(Compare(Name(identifier(function_pointer_0)),Eq,IntNum(4285200)), Compare(Name(identifier(function_pointer_0)),Eq,IntNum(4285872)))),None,Some(CalcBooleanType),DocSpec(Some(True if this is a KOTOR 2 model),List()))
<a name='type-mdl-light_header'></a>
<h2>Type: LightHeader</h2>

<p>Light header (92 bytes)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>unknown</td>
<td>f4le</td>
<td>Purpose unknown, possibly padding or reserved values</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>flare_sizes_offset</td>
<td>u4le</td>
<td>Offset to flare sizes array (floats)</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>flare_sizes_count</td>
<td>u4le</td>
<td>Number of flare size entries</td>
</tr>
<tr>
<td>24</td>
<td>...</td>
<td>flare_sizes_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of flare sizes count</td>
</tr>
<tr>
<td>28</td>
<td>...</td>
<td>flare_positions_offset</td>
<td>u4le</td>
<td>Offset to flare positions array (floats, 0.0-1.0 along light ray)</td>
</tr>
<tr>
<td>32</td>
<td>...</td>
<td>flare_positions_count</td>
<td>u4le</td>
<td>Number of flare position entries</td>
</tr>
<tr>
<td>36</td>
<td>...</td>
<td>flare_positions_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of flare positions count</td>
</tr>
<tr>
<td>40</td>
<td>...</td>
<td>flare_color_shifts_offset</td>
<td>u4le</td>
<td>Offset to flare color shift array (RGB floats)</td>
</tr>
<tr>
<td>44</td>
<td>...</td>
<td>flare_color_shifts_count</td>
<td>u4le</td>
<td>Number of flare color shift entries</td>
</tr>
<tr>
<td>48</td>
<td>...</td>
<td>flare_color_shifts_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of flare color shifts count</td>
</tr>
<tr>
<td>52</td>
<td>...</td>
<td>flare_texture_names_offset</td>
<td>u4le</td>
<td>Offset to flare texture name string offsets array</td>
</tr>
<tr>
<td>56</td>
<td>...</td>
<td>flare_texture_names_count</td>
<td>u4le</td>
<td>Number of flare texture names</td>
</tr>
<tr>
<td>60</td>
<td>...</td>
<td>flare_texture_names_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of flare texture names count</td>
</tr>
<tr>
<td>64</td>
<td>...</td>
<td>flare_radius</td>
<td>f4le</td>
<td>Radius of flare effect</td>
</tr>
<tr>
<td>68</td>
<td>...</td>
<td>light_priority</td>
<td>u4le</td>
<td>Rendering priority for light culling/sorting</td>
</tr>
<tr>
<td>72</td>
<td>...</td>
<td>ambient_only</td>
<td>u4le</td>
<td>1 if light only affects ambient, 0 for full lighting</td>
</tr>
<tr>
<td>76</td>
<td>...</td>
<td>dynamic_type</td>
<td>u4le</td>
<td>Type of dynamic lighting behavior</td>
</tr>
<tr>
<td>80</td>
<td>...</td>
<td>affect_dynamic</td>
<td>u4le</td>
<td>1 if light affects dynamic objects, 0 otherwise</td>
</tr>
<tr>
<td>84</td>
<td>...</td>
<td>shadow</td>
<td>u4le</td>
<td>1 if light casts shadows, 0 otherwise</td>
</tr>
<tr>
<td>88</td>
<td>...</td>
<td>flare</td>
<td>u4le</td>
<td>1 if lens flare effect enabled, 0 otherwise</td>
</tr>
<tr>
<td>92</td>
<td>...</td>
<td>fading_light</td>
<td>u4le</td>
<td>1 if light intensity fades with distance, 0 otherwise</td>
</tr>
</table>
<a name='type-mdl-lightsaber_header'></a>
<h2>Type: LightsaberHeader</h2>

<p>Lightsaber header (352 bytes KOTOR 1, 360 bytes KOTOR 2) - extends trimesh_header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>trimesh_base</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td>Standard trimesh header</td>
</tr>
<tr>
<td>344</td>
<td>...</td>
<td>vertices_offset</td>
<td>u4le</td>
<td>Offset to vertex position array in MDL file (3 floats × 8 vertices × 20 pieces)</td>
</tr>
<tr>
<td>348</td>
<td>...</td>
<td>texcoords_offset</td>
<td>u4le</td>
<td>Offset to texture coordinates array in MDL file (2 floats × 8 vertices × 20)</td>
</tr>
<tr>
<td>352</td>
<td>...</td>
<td>normals_offset</td>
<td>u4le</td>
<td>Offset to vertex normals array in MDL file (3 floats × 8 vertices × 20)</td>
</tr>
<tr>
<td>356</td>
<td>...</td>
<td>unknown1</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
<tr>
<td>360</td>
<td>...</td>
<td>unknown2</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
</table>
<a name='type-mdl-model_header'></a>
<h2>Type: ModelHeader</h2>

<p>Model header (92 bytes) - Located at offset 92</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>classification</td>
<td>u1</td>
<td>Model classification:
- 0x00: Other
- 0x01: Effect
- 0x02: Tile
- 0x04: Character
- 0x08: Door
- 0x10: Lightsaber
- 0x20: Placeable
- 0x40: Flyer
</td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>subclassification</td>
<td>u1</td>
<td>Model subclassification value</td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>unknown</td>
<td>u1</td>
<td>Purpose unknown (possibly smoothing-related)</td>
</tr>
<tr>
<td>3</td>
<td>...</td>
<td>affected_by_fog</td>
<td>u1</td>
<td>0 = Not affected by fog, 1 = Affected by fog</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>child_model_count</td>
<td>u4le</td>
<td>Number of child models</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>animation_array_offset</td>
<td>u4le</td>
<td>Offset to animation array (relative to MDL data start, offset 12)</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>animation_count</td>
<td>u4le</td>
<td>Number of animations</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>animation_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of animation count</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>parent_model_pointer</td>
<td>u4le</td>
<td>Pointer to parent model (context-dependent)</td>
</tr>
<tr>
<td>24</td>
<td>...</td>
<td>bounding_box_min</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Minimum coordinates of bounding box (X, Y, Z)</td>
</tr>
<tr>
<td>36</td>
<td>...</td>
<td>bounding_box_max</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Maximum coordinates of bounding box (X, Y, Z)</td>
</tr>
<tr>
<td>48</td>
<td>...</td>
<td>radius</td>
<td>f4le</td>
<td>Radius of model's bounding sphere</td>
</tr>
<tr>
<td>52</td>
<td>...</td>
<td>animation_scale</td>
<td>f4le</td>
<td>Scale factor for animations (typically 1.0)</td>
</tr>
<tr>
<td>56</td>
<td>...</td>
<td>supermodel_name</td>
<td>str(ASCII)</td>
<td>Name of supermodel (null-terminated string, "null" if empty)</td>
</tr>
</table>
<a name='type-mdl-name_strings'></a>
<h2>Type: NameStrings</h2>

<p>Array of null-terminated name strings</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>strings</td>
<td>str(term=0, ASCII)</td>
<td></td>
</tr>
</table>
<a name='type-mdl-names_header'></a>
<h2>Type: NamesHeader</h2>

<p>Names header (28 bytes) - Located at offset 180</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>root_node_offset</td>
<td>u4le</td>
<td>Offset to root node (often duplicate of geometry header value)</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>unknown_padding</td>
<td>u4le</td>
<td>Unknown field, typically unused or padding</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>mdx_data_size</td>
<td>u4le</td>
<td>Size of MDX file data in bytes</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>mdx_data_offset</td>
<td>u4le</td>
<td>Offset to MDX data within MDX file (typically 0)</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>names_array_offset</td>
<td>u4le</td>
<td>Offset to array of name string offsets</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>name_count</td>
<td>u4le</td>
<td>Number of node names in array</td>
</tr>
<tr>
<td>24</td>
<td>...</td>
<td>name_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of name count</td>
</tr>
</table>
<a name='type-mdl-node'></a>
<h2>Type: Node</h2>

<p>Node structure - starts with 80-byte header, followed by type-specific sub-header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>header</td>
<td><a href="#type-mdl-node_header">NodeHeader</a></td>
<td></td>
</tr>
<tr>
<td>80</td>
<td>...</td>
<td>light_sub_header</td>
<td><a href="#type-mdl-light_header">LightHeader</a></td>
<td></td>
</tr>
<tr>
<td>176</td>
<td>...</td>
<td>emitter_sub_header</td>
<td><a href="#type-mdl-emitter_header">EmitterHeader</a></td>
<td></td>
</tr>
<tr>
<td>416</td>
<td>...</td>
<td>reference_sub_header</td>
<td><a href="#type-mdl-reference_header">ReferenceHeader</a></td>
<td></td>
</tr>
<tr>
<td>452</td>
<td>...</td>
<td>trimesh_sub_header</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td></td>
</tr>
<tr>
<td>796</td>
<td>...</td>
<td>skinmesh_sub_header</td>
<td><a href="#type-mdl-skinmesh_header">SkinmeshHeader</a></td>
<td></td>
</tr>
<tr>
<td>1230</td>
<td>...</td>
<td>animmesh_sub_header</td>
<td><a href="#type-mdl-animmesh_header">AnimmeshHeader</a></td>
<td></td>
</tr>
<tr>
<td>1626</td>
<td>...</td>
<td>danglymesh_sub_header</td>
<td><a href="#type-mdl-danglymesh_header">DanglymeshHeader</a></td>
<td></td>
</tr>
<tr>
<td>1998</td>
<td>...</td>
<td>aabb_sub_header</td>
<td><a href="#type-mdl-aabb_header">AabbHeader</a></td>
<td></td>
</tr>
<tr>
<td>2346</td>
<td>...</td>
<td>lightsaber_sub_header</td>
<td><a href="#type-mdl-lightsaber_header">LightsaberHeader</a></td>
<td></td>
</tr>
</table>
<a name='type-mdl-node_header'></a>
<h2>Type: NodeHeader</h2>

<p>Node header (80 bytes) - present in all node types</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>node_type</td>
<td>u2le</td>
<td>Bitmask indicating node features:
- 0x0001: NODE_HAS_HEADER
- 0x0002: NODE_HAS_LIGHT
- 0x0004: NODE_HAS_EMITTER
- 0x0008: NODE_HAS_CAMERA
- 0x0010: NODE_HAS_REFERENCE
- 0x0020: NODE_HAS_MESH
- 0x0040: NODE_HAS_SKIN
- 0x0080: NODE_HAS_ANIM
- 0x0100: NODE_HAS_DANGLY
- 0x0200: NODE_HAS_AABB
- 0x0800: NODE_HAS_SABER
</td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>node_index</td>
<td>u2le</td>
<td>Sequential index of this node in the model</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>node_name_index</td>
<td>u2le</td>
<td>Index into names array for this node's name</td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>padding</td>
<td>u2le</td>
<td>Padding for alignment</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>root_node_offset</td>
<td>u4le</td>
<td>Offset to model's root node</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>parent_node_offset</td>
<td>u4le</td>
<td>Offset to this node's parent node (0 if root)</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>position</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Node position in local space (X, Y, Z)</td>
</tr>
<tr>
<td>28</td>
<td>...</td>
<td>orientation</td>
<td><a href="#type-mdl-quaternion">Quaternion</a></td>
<td>Node orientation as quaternion (W, X, Y, Z)</td>
</tr>
<tr>
<td>44</td>
<td>...</td>
<td>child_array_offset</td>
<td>u4le</td>
<td>Offset to array of child node offsets</td>
</tr>
<tr>
<td>48</td>
<td>...</td>
<td>child_count</td>
<td>u4le</td>
<td>Number of child nodes</td>
</tr>
<tr>
<td>52</td>
<td>...</td>
<td>child_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of child count</td>
</tr>
<tr>
<td>56</td>
<td>...</td>
<td>controller_array_offset</td>
<td>u4le</td>
<td>Offset to array of controller structures</td>
</tr>
<tr>
<td>60</td>
<td>...</td>
<td>controller_count</td>
<td>u4le</td>
<td>Number of controllers attached to this node</td>
</tr>
<tr>
<td>64</td>
<td>...</td>
<td>controller_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of controller count</td>
</tr>
<tr>
<td>68</td>
<td>...</td>
<td>controller_data_offset</td>
<td>u4le</td>
<td>Offset to controller keyframe/data array</td>
</tr>
<tr>
<td>72</td>
<td>...</td>
<td>controller_data_count</td>
<td>u4le</td>
<td>Number of floats in controller data array</td>
</tr>
<tr>
<td>76</td>
<td>...</td>
<td>controller_data_count_duplicate</td>
<td>u4le</td>
<td>Duplicate value of controller data count</td>
</tr>
</table>
value instance: ValueInstanceSpec(InstanceIdentifier(has_aabb),List(types, node_header, instances, has_aabb),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(512)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_anim),List(types, node_header, instances, has_anim),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(128)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_dangly),List(types, node_header, instances, has_dangly),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(256)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_emitter),List(types, node_header, instances, has_emitter),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(4)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_light),List(types, node_header, instances, has_light),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(2)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_mesh),List(types, node_header, instances, has_mesh),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(32)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_reference),List(types, node_header, instances, has_reference),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(16)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_saber),List(types, node_header, instances, has_saber),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(2048)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
value instance: ValueInstanceSpec(InstanceIdentifier(has_skin),List(types, node_header, instances, has_skin),Compare(BinOp(Name(identifier(node_type)),BitAnd,IntNum(64)),NotEq,IntNum(0)),None,Some(CalcBooleanType),DocSpec(None,List()))
<a name='type-mdl-quaternion'></a>
<h2>Type: Quaternion</h2>

<p>Quaternion rotation (4 floats W, X, Y, Z)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>w</td>
<td>f4le</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>x</td>
<td>f4le</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>y</td>
<td>f4le</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>z</td>
<td>f4le</td>
<td></td>
</tr>
</table>
<a name='type-mdl-reference_header'></a>
<h2>Type: ReferenceHeader</h2>

<p>Reference header (36 bytes)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>model_resref</td>
<td>str(ASCII)</td>
<td>Referenced model resource name without extension (null-terminated string)</td>
</tr>
<tr>
<td>32</td>
<td>...</td>
<td>reattachable</td>
<td>u4le</td>
<td>1 if model can be detached and reattached dynamically, 0 if permanent</td>
</tr>
</table>
<a name='type-mdl-skinmesh_header'></a>
<h2>Type: SkinmeshHeader</h2>

<p>Skinmesh header (432 bytes KOTOR 1, 440 bytes KOTOR 2) - extends trimesh_header</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>trimesh_base</td>
<td><a href="#type-mdl-trimesh_header">TrimeshHeader</a></td>
<td>Standard trimesh header</td>
</tr>
<tr>
<td>344</td>
<td>...</td>
<td>unknown_weights</td>
<td>s4le</td>
<td>Purpose unknown (possibly compilation weights)</td>
</tr>
<tr>
<td>348</td>
<td>...</td>
<td>padding1</td>
<td>u1</td>
<td>Padding</td>
</tr>
<tr>
<td>356</td>
<td>...</td>
<td>mdx_bone_weights_offset</td>
<td>u4le</td>
<td>Offset to bone weight data in MDX file (4 floats per vertex)</td>
</tr>
<tr>
<td>360</td>
<td>...</td>
<td>mdx_bone_indices_offset</td>
<td>u4le</td>
<td>Offset to bone index data in MDX file (4 floats per vertex, cast to uint16)</td>
</tr>
<tr>
<td>364</td>
<td>...</td>
<td>bone_map_offset</td>
<td>u4le</td>
<td>Offset to bone map array (maps local bone indices to skeleton bone numbers)</td>
</tr>
<tr>
<td>368</td>
<td>...</td>
<td>bone_map_count</td>
<td>u4le</td>
<td>Number of bones referenced by this mesh (max 16)</td>
</tr>
<tr>
<td>372</td>
<td>...</td>
<td>qbones_offset</td>
<td>u4le</td>
<td>Offset to quaternion bind pose array (4 floats per bone)</td>
</tr>
<tr>
<td>376</td>
<td>...</td>
<td>qbones_count</td>
<td>u4le</td>
<td>Number of quaternion bind poses</td>
</tr>
<tr>
<td>380</td>
<td>...</td>
<td>qbones_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of QBones count</td>
</tr>
<tr>
<td>384</td>
<td>...</td>
<td>tbones_offset</td>
<td>u4le</td>
<td>Offset to translation bind pose array (3 floats per bone)</td>
</tr>
<tr>
<td>388</td>
<td>...</td>
<td>tbones_count</td>
<td>u4le</td>
<td>Number of translation bind poses</td>
</tr>
<tr>
<td>392</td>
<td>...</td>
<td>tbones_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of TBones count</td>
</tr>
<tr>
<td>396</td>
<td>...</td>
<td>unknown_array</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
<tr>
<td>400</td>
<td>...</td>
<td>bone_node_serial_numbers</td>
<td>u2le</td>
<td>Serial indices of bone nodes (0xFFFF for unused slots)</td>
</tr>
<tr>
<td>432</td>
<td>...</td>
<td>padding2</td>
<td>u2le</td>
<td>Padding for alignment</td>
</tr>
</table>
<a name='type-mdl-trimesh_header'></a>
<h2>Type: TrimeshHeader</h2>

<p>Trimesh header (332 bytes KOTOR 1, 340 bytes KOTOR 2)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>function_pointer_0</td>
<td>u4le</td>
<td>Game engine function pointer (version-specific)</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>function_pointer_1</td>
<td>u4le</td>
<td>Secondary game engine function pointer</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>faces_array_offset</td>
<td>u4le</td>
<td>Offset to face definitions array</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>faces_count</td>
<td>u4le</td>
<td>Number of triangular faces in mesh</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>faces_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of faces count</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>bounding_box_min</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Minimum bounding box coordinates (X, Y, Z)</td>
</tr>
<tr>
<td>32</td>
<td>...</td>
<td>bounding_box_max</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Maximum bounding box coordinates (X, Y, Z)</td>
</tr>
<tr>
<td>44</td>
<td>...</td>
<td>radius</td>
<td>f4le</td>
<td>Bounding sphere radius</td>
</tr>
<tr>
<td>48</td>
<td>...</td>
<td>average_point</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Average vertex position (centroid) X, Y, Z</td>
</tr>
<tr>
<td>60</td>
<td>...</td>
<td>diffuse_color</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Material diffuse color (R, G, B, range 0.0-1.0)</td>
</tr>
<tr>
<td>72</td>
<td>...</td>
<td>ambient_color</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>Material ambient color (R, G, B, range 0.0-1.0)</td>
</tr>
<tr>
<td>84</td>
<td>...</td>
<td>transparency_hint</td>
<td>u4le</td>
<td>Transparency rendering mode</td>
</tr>
<tr>
<td>88</td>
<td>...</td>
<td>texture_0_name</td>
<td>str(ASCII)</td>
<td>Primary diffuse texture name (null-terminated string)</td>
</tr>
<tr>
<td>120</td>
<td>...</td>
<td>texture_1_name</td>
<td>str(ASCII)</td>
<td>Secondary texture name, often lightmap (null-terminated string)</td>
</tr>
<tr>
<td>152</td>
<td>...</td>
<td>texture_2_name</td>
<td>str(ASCII)</td>
<td>Tertiary texture name (null-terminated string)</td>
</tr>
<tr>
<td>164</td>
<td>...</td>
<td>texture_3_name</td>
<td>str(ASCII)</td>
<td>Quaternary texture name (null-terminated string)</td>
</tr>
<tr>
<td>176</td>
<td>...</td>
<td>indices_count_array_offset</td>
<td>u4le</td>
<td>Offset to vertex indices count array</td>
</tr>
<tr>
<td>180</td>
<td>...</td>
<td>indices_count_array_count</td>
<td>u4le</td>
<td>Number of entries in indices count array</td>
</tr>
<tr>
<td>184</td>
<td>...</td>
<td>indices_count_array_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of indices count array count</td>
</tr>
<tr>
<td>188</td>
<td>...</td>
<td>indices_offset_array_offset</td>
<td>u4le</td>
<td>Offset to vertex indices offset array</td>
</tr>
<tr>
<td>192</td>
<td>...</td>
<td>indices_offset_array_count</td>
<td>u4le</td>
<td>Number of entries in indices offset array</td>
</tr>
<tr>
<td>196</td>
<td>...</td>
<td>indices_offset_array_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of indices offset array count</td>
</tr>
<tr>
<td>200</td>
<td>...</td>
<td>inverted_counter_array_offset</td>
<td>u4le</td>
<td>Offset to inverted counter array</td>
</tr>
<tr>
<td>204</td>
<td>...</td>
<td>inverted_counter_array_count</td>
<td>u4le</td>
<td>Number of entries in inverted counter array</td>
</tr>
<tr>
<td>208</td>
<td>...</td>
<td>inverted_counter_array_count_duplicate</td>
<td>u4le</td>
<td>Duplicate of inverted counter array count</td>
</tr>
<tr>
<td>212</td>
<td>...</td>
<td>unknown_values</td>
<td>s4le</td>
<td>Typically {-1, -1, 0}, purpose unknown</td>
</tr>
<tr>
<td>224</td>
<td>...</td>
<td>saber_unknown_data</td>
<td>u1</td>
<td>Data specific to lightsaber meshes</td>
</tr>
<tr>
<td>232</td>
<td>...</td>
<td>unknown</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
<tr>
<td>236</td>
<td>...</td>
<td>uv_direction</td>
<td><a href="#type-mdl-vec3f">Vec3f</a></td>
<td>UV animation direction X, Y components (Z = jitter speed)</td>
</tr>
<tr>
<td>248</td>
<td>...</td>
<td>uv_jitter</td>
<td>f4le</td>
<td>UV animation jitter amount</td>
</tr>
<tr>
<td>252</td>
<td>...</td>
<td>uv_jitter_speed</td>
<td>f4le</td>
<td>UV animation jitter speed</td>
</tr>
<tr>
<td>256</td>
<td>...</td>
<td>mdx_vertex_size</td>
<td>u4le</td>
<td>Size in bytes of each vertex in MDX data</td>
</tr>
<tr>
<td>260</td>
<td>...</td>
<td>mdx_data_flags</td>
<td>u4le</td>
<td>Bitmask of present vertex attributes:
- 0x00000001: MDX_VERTICES (vertex positions)
- 0x00000002: MDX_TEX0_VERTICES (primary texture coordinates)
- 0x00000004: MDX_TEX1_VERTICES (secondary texture coordinates)
- 0x00000008: MDX_TEX2_VERTICES (tertiary texture coordinates)
- 0x00000010: MDX_TEX3_VERTICES (quaternary texture coordinates)
- 0x00000020: MDX_VERTEX_NORMALS (vertex normals)
- 0x00000040: MDX_VERTEX_COLORS (vertex colors)
- 0x00000080: MDX_TANGENT_SPACE (tangent space data)
</td>
</tr>
<tr>
<td>264</td>
<td>...</td>
<td>mdx_vertices_offset</td>
<td>s4le</td>
<td>Relative offset to vertex positions in MDX (or -1 if none)</td>
</tr>
<tr>
<td>268</td>
<td>...</td>
<td>mdx_normals_offset</td>
<td>s4le</td>
<td>Relative offset to vertex normals in MDX (or -1 if none)</td>
</tr>
<tr>
<td>272</td>
<td>...</td>
<td>mdx_vertex_colors_offset</td>
<td>s4le</td>
<td>Relative offset to vertex colors in MDX (or -1 if none)</td>
</tr>
<tr>
<td>276</td>
<td>...</td>
<td>mdx_tex0_uvs_offset</td>
<td>s4le</td>
<td>Relative offset to primary texture UVs in MDX (or -1 if none)</td>
</tr>
<tr>
<td>280</td>
<td>...</td>
<td>mdx_tex1_uvs_offset</td>
<td>s4le</td>
<td>Relative offset to secondary texture UVs in MDX (or -1 if none)</td>
</tr>
<tr>
<td>284</td>
<td>...</td>
<td>mdx_tex2_uvs_offset</td>
<td>s4le</td>
<td>Relative offset to tertiary texture UVs in MDX (or -1 if none)</td>
</tr>
<tr>
<td>288</td>
<td>...</td>
<td>mdx_tex3_uvs_offset</td>
<td>s4le</td>
<td>Relative offset to quaternary texture UVs in MDX (or -1 if none)</td>
</tr>
<tr>
<td>292</td>
<td>...</td>
<td>mdx_tangent_space_offset</td>
<td>s4le</td>
<td>Relative offset to tangent space data in MDX (or -1 if none)</td>
</tr>
<tr>
<td>296</td>
<td>...</td>
<td>mdx_unknown_offset_1</td>
<td>s4le</td>
<td>Relative offset to unknown MDX data (or -1 if none)</td>
</tr>
<tr>
<td>300</td>
<td>...</td>
<td>mdx_unknown_offset_2</td>
<td>s4le</td>
<td>Relative offset to unknown MDX data (or -1 if none)</td>
</tr>
<tr>
<td>304</td>
<td>...</td>
<td>mdx_unknown_offset_3</td>
<td>s4le</td>
<td>Relative offset to unknown MDX data (or -1 if none)</td>
</tr>
<tr>
<td>308</td>
<td>...</td>
<td>vertex_count</td>
<td>u2le</td>
<td>Number of vertices in mesh</td>
</tr>
<tr>
<td>310</td>
<td>...</td>
<td>texture_count</td>
<td>u2le</td>
<td>Number of textures used by mesh</td>
</tr>
<tr>
<td>312</td>
<td>...</td>
<td>lightmapped</td>
<td>u1</td>
<td>1 if mesh uses lightmap, 0 otherwise</td>
</tr>
<tr>
<td>313</td>
<td>...</td>
<td>rotate_texture</td>
<td>u1</td>
<td>1 if texture should rotate, 0 otherwise</td>
</tr>
<tr>
<td>314</td>
<td>...</td>
<td>background_geometry</td>
<td>u1</td>
<td>1 if background geometry, 0 otherwise</td>
</tr>
<tr>
<td>315</td>
<td>...</td>
<td>shadow</td>
<td>u1</td>
<td>1 if mesh casts shadows, 0 otherwise</td>
</tr>
<tr>
<td>316</td>
<td>...</td>
<td>beaming</td>
<td>u1</td>
<td>1 if beaming effect enabled, 0 otherwise</td>
</tr>
<tr>
<td>317</td>
<td>...</td>
<td>render</td>
<td>u1</td>
<td>1 if mesh is renderable, 0 if hidden</td>
</tr>
<tr>
<td>318</td>
<td>...</td>
<td>unknown_flag</td>
<td>u1</td>
<td>Purpose unknown (possibly UV animation enable)</td>
</tr>
<tr>
<td>319</td>
<td>...</td>
<td>padding</td>
<td>u1</td>
<td>Padding byte</td>
</tr>
<tr>
<td>320</td>
<td>...</td>
<td>total_area</td>
<td>f4le</td>
<td>Total surface area of all faces</td>
</tr>
<tr>
<td>324</td>
<td>...</td>
<td>unknown2</td>
<td>u4le</td>
<td>Purpose unknown</td>
</tr>
<tr>
<td>328</td>
<td>...</td>
<td>k2_unknown_1</td>
<td>u4le</td>
<td>KOTOR 2 only: Additional unknown field</td>
</tr>
<tr>
<td>332</td>
<td>...</td>
<td>k2_unknown_2</td>
<td>u4le</td>
<td>KOTOR 2 only: Additional unknown field</td>
</tr>
<tr>
<td>336</td>
<td>...</td>
<td>mdx_data_offset</td>
<td>u4le</td>
<td>Absolute offset to this mesh's vertex data in MDX file</td>
</tr>
<tr>
<td>340</td>
<td>...</td>
<td>mdl_vertices_offset</td>
<td>u4le</td>
<td>Offset to vertex coordinate array in MDL file (for walkmesh/AABB nodes)</td>
</tr>
</table>
<a name='type-mdl-vec3f'></a>
<h2>Type: Vec3f</h2>

<p>3D vector (3 floats)</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>x</td>
<td>f4le</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>y</td>
<td>f4le</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>z</td>
<td>f4le</td>
<td></td>
</tr>
</table>

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
