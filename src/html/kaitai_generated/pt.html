
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Pt format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>Pt format specification</h1>

      
<a name='type-pt'></a>
<h1>Type: Pt</h1>

<p>PT (Party Table) files are GFF-based format files that store party and game state information
for Odyssey Engine games (KotOR and KotOR 2). PT files use the GFF (Generic File Format) binary
structure with file type signature "PT  ".

This format inherits the complete GFF structure from gff.ksy and adds PT-specific
validation and documentation.

PT files are typically named "PARTYTABLE.res" and are stored in savegame.sav ERF archives.
They contain comprehensive party and game state information including:
- Party composition (current members, available NPCs, leader)
- Resources (gold/credits, XP pool, components, chemicals)
- Journal entries with states, dates, and times
- Pazaak cards and side decks for the mini-game
- UI state (last panel, messages, tutorial windows shown)
- AI state (follow mode, AI enabled, solo mode)
- K2-specific: Influence values per companion

PT Root Struct Fields (Common):
- "PT_PCNAME" (String): Player character name
- "PT_GOLD" (Int32): Credits/gold amount
- "PT_XP_POOL" (Int32): Experience points
- "PT_PLAYEDSECONDS" (UInt32): Total playtime in seconds
- "PT_NUM_MEMBERS" (Int32): Party member count
- "PT_CONTROLLED_NPC", "PT_SOLOMODE", "PT_AISTATE", "PT_FOLLOWSTATE" (Int32): AI/party state
- "PT_MEMBERS" (List): Party member ResRefs and leader flags
- "PT_AVAIL_NPCS" (List): Available NPCs for recruitment
- "PT_INFLUENCE" (List): Influence values (KotOR 2 only)
- "PT_PAZAAKCARDS", "PT_PAZSIDELIST" (List): Pazaak card collections
- Journal/message lists: "PT_FB_MSG_LIST", "PT_DLG_MSG_LIST", "PT_COM_MSG_LIST"

Based on swkotor2.exe: SavePartyTable @ 0x0057bd70

References:
- https://github.com/OldRepublicDevs/PyKotor/blob/master/Libraries/PyKotor/src/pykotor/extract/savedata.py
- https://github.com/OldRepublicDevs/PyKotor/wiki/GFF-PT.md
- https://github.com/OldRepublicDevs/PyKotor/wiki/GFF-File-Format.md
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>gff_data</td>
<td><a href="#type-gff">Gff</a></td>
<td>Complete GFF structure. PT files use standard GFF format with "PT  " file type.
Access via: gff_data.header, gff_data.struct_array, gff_data.field_array, etc.
</td>
</tr>
</table>
value instance: ValueInstanceSpec(InstanceIdentifier(file_type_valid),List(instances, file_type_valid),Compare(Attribute(Attribute(Name(identifier(gff_data)),identifier(header)),identifier(file_type)),Eq,Str(PT  )),None,Some(CalcBooleanType),DocSpec(Some(Validates that this is a PT file (file type must be "PT  ")),List()))
value instance: ValueInstanceSpec(InstanceIdentifier(version_valid),List(instances, version_valid),BoolOp(Or,List(Compare(Attribute(Attribute(Name(identifier(gff_data)),identifier(header)),identifier(file_version)),Eq,Str(V3.2)), Compare(Attribute(Attribute(Name(identifier(gff_data)),identifier(header)),identifier(file_version)),Eq,Str(V3.3)), Compare(Attribute(Attribute(Name(identifier(gff_data)),identifier(header)),identifier(file_version)),Eq,Str(V4.0)), Compare(Attribute(Attribute(Name(identifier(gff_data)),identifier(header)),identifier(file_version)),Eq,Str(V4.1)))),None,Some(CalcBooleanType),DocSpec(Some(Validates GFF version is supported),List()))

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
