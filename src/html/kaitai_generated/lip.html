
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Lip format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>Lip format specification</h1>

      
<a name='type-lip'></a>
<h1>Type: Lip</h1>

<p>LIP (LIP Synchronization) files drive mouth animation for voiced dialogue in BioWare games.
Each file contains a compact series of keyframes that map timestamps to discrete viseme
(mouth shape) indices so that the engine can interpolate character lip movement while
playing the companion WAV audio line.

LIP files are always binary and contain only animation data. They are paired with WAV
voice-over resources of identical duration; the LIP length field must match the WAV
playback time for glitch-free animation.

Keyframes are sorted chronologically and store a timestamp (float seconds) plus a
1-byte viseme index (0-15). The format uses the 16-shape Preston Blair phoneme set.

References:
- https://github.com/OldRepublicDevs/PyKotor/wiki/LIP-File-Format.md
- https://github.com/seedhartha/reone/blob/master/src/libs/graphics/format/lipreader.cpp:27-42
- https://github.com/xoreos/xoreos/blob/master/src/graphics/aurora/lipfile.cpp
- https://github.com/KotOR-Community-Patches/KotOR.js/blob/master/src/resource/LIPObject.ts:93-146
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>file_type</td>
<td>str(ASCII)</td>
<td>File type signature. Must be "LIP " (space-padded) for LIP files.</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>file_version</td>
<td>str(ASCII)</td>
<td>File format version. Must be "V1.0" for LIP files.</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>length</td>
<td>f4le</td>
<td>Duration in seconds. Must equal the paired WAV file playback time for
glitch-free animation. This is the total length of the lip sync animation.
</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>num_keyframes</td>
<td>u4le</td>
<td>Number of keyframes immediately following. Each keyframe contains a timestamp
and a viseme shape index. Keyframes should be sorted ascending by timestamp.
</td>
</tr>
<tr>
<td>16</td>
<td>...</td>
<td>keyframes</td>
<td><a href="#type-lip-keyframe_entry">KeyframeEntry</a></td>
<td>Array of keyframe entries. Each entry maps a timestamp to a mouth shape.
Entries must be stored in chronological order (ascending by timestamp).
</td>
</tr>
</table>
<a name='enum-lip-lip_shapes'></a>
<h2>Enum: lip_shapes</h2>

<table class="table">
<tr>
<th>ID</th><th>Name</th><th>Note</th>
</tr>
<tr>
<td>0</td><td>neutral</td><td></td></tr>
</tr>
<tr>
<td>1</td><td>ee</td><td></td></tr>
</tr>
<tr>
<td>2</td><td>eh</td><td></td></tr>
</tr>
<tr>
<td>3</td><td>ah</td><td></td></tr>
</tr>
<tr>
<td>4</td><td>oh</td><td></td></tr>
</tr>
<tr>
<td>5</td><td>ooh</td><td></td></tr>
</tr>
<tr>
<td>6</td><td>y</td><td></td></tr>
</tr>
<tr>
<td>7</td><td>sts</td><td></td></tr>
</tr>
<tr>
<td>8</td><td>fv</td><td></td></tr>
</tr>
<tr>
<td>9</td><td>ng</td><td></td></tr>
</tr>
<tr>
<td>10</td><td>th</td><td></td></tr>
</tr>
<tr>
<td>11</td><td>mpb</td><td></td></tr>
</tr>
<tr>
<td>12</td><td>td</td><td></td></tr>
</tr>
<tr>
<td>13</td><td>sh</td><td></td></tr>
</tr>
<tr>
<td>14</td><td>l</td><td></td></tr>
</tr>
<tr>
<td>15</td><td>kg</td><td></td></tr>
</tr>
</table>
<a name='type-lip-keyframe_entry'></a>
<h2>Type: KeyframeEntry</h2>

<p>A single keyframe entry mapping a timestamp to a viseme (mouth shape).
Keyframes are used by the engine to interpolate between mouth shapes during
audio playback to create lip sync animation.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>timestamp</td>
<td>f4le</td>
<td>Seconds from animation start. Must be >= 0 and <= length.
Keyframes should be sorted ascending by timestamp.
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>shape</td>
<td>u1â†’LipShapes</td>
<td>Viseme index (0-15) indicating which mouth shape to use at this timestamp.
Uses the 16-shape Preston Blair phoneme set. See lip_shapes enum for details.
</td>
</tr>
</table>

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
