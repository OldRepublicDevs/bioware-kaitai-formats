// Code generated by kaitai-struct-compiler from a .ksy source file. DO NOT EDIT.

import "github.com/kaitai-io/kaitai_struct_go_runtime/kaitai"


/**
 * NSS (NWScript Source) files contain human-readable NWScript source code
 * that compiles to NCS bytecode. NWScript is the scripting language used
 * in KotOR, TSL, and Neverwinter Nights.
 * 
 * NSS files are plain text files (typically Windows-1252 or UTF-8 encoding)
 * containing NWScript source code. The nwscript.nss file defines all
 * engine-exposed functions and constants available to scripts.
 * 
 * Format:
 * - Plain text source code
 * - May include BOM (Byte Order Mark) for UTF-8 files
 * - Lines are typically terminated with CRLF (\r\n) or LF (\n)
 * - Comments: // for single-line, /* */ for multi-line
 * - Preprocessor directives: #include, #define, etc.
 * 
 * References:
 * - https://github.com/OldRepublicDevs/PyKotor/wiki/NSS-File-Format.md
 * - https://github.com/xoreos/xoreos-tools/tree/master/src/nwscript/ (NWScript compiler)
 * - https://github.com/seedhartha/reone/blob/master/src/libs/script/ (Script execution engine)
 */
type Nss struct {
	Bom uint16
	SourceCode string
	_io *kaitai.Stream
	_root *Nss
	_parent kaitai.Struct
}
func NewNss() *Nss {
	return &Nss{
	}
}

func (this Nss) IO_() *kaitai.Stream {
	return this._io
}

func (this *Nss) Read(io *kaitai.Stream, parent kaitai.Struct, root *Nss) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp1, err := this._io.Pos()
	if err != nil {
		return err
	}
	if (tmp1 == 0) {
		tmp2, err := this._io.ReadU2le()
		if err != nil {
			return err
		}
		this.Bom = uint16(tmp2)
		if !( ((this.Bom == 65279) || (this.Bom == 0)) ) {
			return kaitai.NewValidationNotAnyOfError(this.Bom, this._io, "/seq/0")
		}
	}
	tmp3, err := this._io.ReadBytesFull()
	if err != nil {
		return err
	}
	tmp3 = tmp3
	this.SourceCode = string(tmp3)
	return err
}

/**
 * Optional UTF-8 BOM (Byte Order Mark) at the start of the file.
 * If present, will be 0xFEFF (UTF-8 BOM).
 * Most NSS files do not include a BOM.
 */

/**
 * Complete NWScript source code.
 * Contains function definitions, variable declarations, control flow
 * statements, and engine function calls.
 * 
 * Common elements:
 * - Function definitions: void function_name() { ... }
 * - Variable declarations: int variable_name;
 * - Control flow: if, while, for, switch
 * - Engine function calls: GetFirstObject(), GetObjectByTag(), etc.
 * - Constants: OBJECT_SELF, OBJECT_INVALID, etc.
 * 
 * The source code is compiled to NCS bytecode by the NWScript compiler.
 */

/**
 * NWScript source code structure.
 * This is primarily a text format, so the main content is the source_code string.
 * 
 * The source can be parsed into:
 * - Tokens (keywords, identifiers, operators, literals)
 * - Statements (declarations, assignments, control flow)
 * - Functions (definitions with parameters and body)
 * - Preprocessor directives (#include, #define)
 */
type Nss_NssSource struct {
	Content string
	_io *kaitai.Stream
	_root *Nss
	_parent kaitai.Struct
}
func NewNss_NssSource() *Nss_NssSource {
	return &Nss_NssSource{
	}
}

func (this Nss_NssSource) IO_() *kaitai.Stream {
	return this._io
}

func (this *Nss_NssSource) Read(io *kaitai.Stream, parent kaitai.Struct, root *Nss) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp4, err := this._io.ReadBytesFull()
	if err != nil {
		return err
	}
	tmp4 = tmp4
	this.Content = string(tmp4)
	return err
}

/**
 * Complete source code content.
 */
