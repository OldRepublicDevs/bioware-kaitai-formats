digraph {
	rankdir=LR;
	node [shape=plaintext];
	subgraph cluster__wav {
		label="Wav";
		graph[style=dotted];

		wav__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
			<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
			<TR><TD PORT="riff_header_pos">0</TD><TD PORT="riff_header_size">12</TD><TD>RiffHeader</TD><TD PORT="riff_header_type">riff_header</TD></TR>
			<TR><TD PORT="chunks_pos">12</TD><TD PORT="chunks_size">...</TD><TD>Chunk</TD><TD PORT="chunks_type">chunks</TD></TR>
			<TR><TD COLSPAN="4" PORT="chunks__repeat">repeat until _io.eof?</TD></TR>
		</TABLE>>];
		subgraph cluster__chunk {
			label="Wav::Chunk";
			graph[style=dotted];

			chunk__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="id_pos">0</TD><TD PORT="id_size">4</TD><TD>str(ASCII)</TD><TD PORT="id_type">id</TD></TR>
				<TR><TD PORT="size_pos">4</TD><TD PORT="size_size">4</TD><TD>u4le</TD><TD PORT="size_type">size</TD></TR>
				<TR><TD PORT="body_pos">8</TD><TD PORT="body_size">...</TD><TD>switch (id)</TD><TD PORT="body_type">body</TD></TR>
			</TABLE>>];
chunk__seq_body_switch [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
	<TR><TD BGCOLOR="#F0F2E4">case</TD><TD BGCOLOR="#F0F2E4">type</TD></TR>
	<TR><TD>_</TD><TD PORT="case0">UnknownChunkBody</TD></TR>
	<TR><TD>&quot;data&quot;</TD><TD PORT="case1">DataChunkBody</TD></TR>
	<TR><TD>&quot;fact&quot;</TD><TD PORT="case2">FactChunkBody</TD></TR>
	<TR><TD>&quot;fmt &quot;</TD><TD PORT="case3">FormatChunkBody</TD></TR>
</TABLE>>];
		}
		subgraph cluster__data_chunk_body {
			label="Wav::DataChunkBody";
			graph[style=dotted];

			data_chunk_body__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="data_pos">0</TD><TD PORT="data_size">_parent.size</TD><TD></TD><TD PORT="data_type">data</TD></TR>
			</TABLE>>];
		}
		subgraph cluster__fact_chunk_body {
			label="Wav::FactChunkBody";
			graph[style=dotted];

			fact_chunk_body__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="sample_count_pos">0</TD><TD PORT="sample_count_size">4</TD><TD>u4le</TD><TD PORT="sample_count_type">sample_count</TD></TR>
			</TABLE>>];
		}
		subgraph cluster__format_chunk_body {
			label="Wav::FormatChunkBody";
			graph[style=dotted];

			format_chunk_body__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="audio_format_pos">0</TD><TD PORT="audio_format_size">2</TD><TD>u2le</TD><TD PORT="audio_format_type">audio_format</TD></TR>
				<TR><TD PORT="channels_pos">2</TD><TD PORT="channels_size">2</TD><TD>u2le</TD><TD PORT="channels_type">channels</TD></TR>
				<TR><TD PORT="sample_rate_pos">4</TD><TD PORT="sample_rate_size">4</TD><TD>u4le</TD><TD PORT="sample_rate_type">sample_rate</TD></TR>
				<TR><TD PORT="bytes_per_sec_pos">8</TD><TD PORT="bytes_per_sec_size">4</TD><TD>u4le</TD><TD PORT="bytes_per_sec_type">bytes_per_sec</TD></TR>
				<TR><TD PORT="block_align_pos">12</TD><TD PORT="block_align_size">2</TD><TD>u2le</TD><TD PORT="block_align_type">block_align</TD></TR>
				<TR><TD PORT="bits_per_sample_pos">14</TD><TD PORT="bits_per_sample_size">2</TD><TD>u2le</TD><TD PORT="bits_per_sample_type">bits_per_sample</TD></TR>
				<TR><TD PORT="extra_format_bytes_pos">16</TD><TD PORT="extra_format_bytes_size">_parent.size - 16</TD><TD></TD><TD PORT="extra_format_bytes_type">extra_format_bytes</TD></TR>
				<TR><TD COLSPAN="4" PORT="extra_format_bytes__if">if _parent.size &gt; 16</TD></TR>
			</TABLE>>];
			format_chunk_body__inst__is_ima_adpcm [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">id</TD><TD BGCOLOR="#E0FFE0">value</TD></TR>
				<TR><TD>is_ima_adpcm</TD><TD>audio_format == 17</TD></TR>
			</TABLE>>];
			format_chunk_body__inst__is_mp3 [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">id</TD><TD BGCOLOR="#E0FFE0">value</TD></TR>
				<TR><TD>is_mp3</TD><TD>audio_format == 85</TD></TR>
			</TABLE>>];
			format_chunk_body__inst__is_pcm [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">id</TD><TD BGCOLOR="#E0FFE0">value</TD></TR>
				<TR><TD>is_pcm</TD><TD>audio_format == 1</TD></TR>
			</TABLE>>];
		}
		subgraph cluster__riff_header {
			label="Wav::RiffHeader";
			graph[style=dotted];

			riff_header__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="riff_id_pos">0</TD><TD PORT="riff_id_size">4</TD><TD>str(ASCII)</TD><TD PORT="riff_id_type">riff_id</TD></TR>
				<TR><TD COLSPAN="4" PORT="riff_id__valid">must be equal to &quot;RIFF&quot;</TD></TR>
				<TR><TD PORT="riff_size_pos">4</TD><TD PORT="riff_size_size">4</TD><TD>u4le</TD><TD PORT="riff_size_type">riff_size</TD></TR>
				<TR><TD PORT="wave_id_pos">8</TD><TD PORT="wave_id_size">4</TD><TD>str(ASCII)</TD><TD PORT="wave_id_type">wave_id</TD></TR>
				<TR><TD COLSPAN="4" PORT="wave_id__valid">must be equal to &quot;WAVE&quot;</TD></TR>
			</TABLE>>];
			riff_header__inst__is_mp3_in_wav [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">id</TD><TD BGCOLOR="#E0FFE0">value</TD></TR>
				<TR><TD>is_mp3_in_wav</TD><TD>riff_size == 50</TD></TR>
			</TABLE>>];
		}
		subgraph cluster__unknown_chunk_body {
			label="Wav::UnknownChunkBody";
			graph[style=dotted];

			unknown_chunk_body__seq [label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0">
				<TR><TD BGCOLOR="#E0FFE0">pos</TD><TD BGCOLOR="#E0FFE0">size</TD><TD BGCOLOR="#E0FFE0">type</TD><TD BGCOLOR="#E0FFE0">id</TD></TR>
				<TR><TD PORT="data_pos">0</TD><TD PORT="data_size">_parent.size</TD><TD></TD><TD PORT="data_type">data</TD></TR>
				<TR><TD PORT="padding_pos">...</TD><TD PORT="padding_size">1</TD><TD>u1</TD><TD PORT="padding_type">padding</TD></TR>
				<TR><TD COLSPAN="4" PORT="padding__if">if _parent.size % 2 == 1</TD></TR>
			</TABLE>>];
		}
	}
	wav__seq:riff_header_type -> riff_header__seq [style=bold];
	wav__seq:chunks_type -> chunk__seq [style=bold];
	chunk__seq:body_type -> chunk__seq_body_switch [style=bold];
	chunk__seq_body_switch:case0 -> unknown_chunk_body__seq [style=bold];
	chunk__seq_body_switch:case1 -> data_chunk_body__seq [style=bold];
	chunk__seq_body_switch:case2 -> fact_chunk_body__seq [style=bold];
	chunk__seq_body_switch:case3 -> format_chunk_body__seq [style=bold];
	chunk__seq:id_type -> chunk__seq:body_type [color="#404040"];
	chunk__seq:size_type -> data_chunk_body__seq:data_size [color="#404040"];
	chunk__seq:size_type -> format_chunk_body__seq:extra_format_bytes_size [color="#404040"];
	chunk__seq:size_type -> format_chunk_body__seq:extra_format_bytes__if [color="#404040"];
	format_chunk_body__seq:audio_format_type -> format_chunk_body__inst__is_ima_adpcm [color="#404040"];
	format_chunk_body__seq:audio_format_type -> format_chunk_body__inst__is_mp3 [color="#404040"];
	format_chunk_body__seq:audio_format_type -> format_chunk_body__inst__is_pcm [color="#404040"];
	riff_header__seq:riff_size_type -> riff_header__inst__is_mp3_in_wav [color="#404040"];
	chunk__seq:size_type -> unknown_chunk_body__seq:data_size [color="#404040"];
	chunk__seq:size_type -> unknown_chunk_body__seq:padding__if [color="#404040"];
}
